import{u,r as o,j as e,a as c}from"./app-f296e0bd.js";import{L as b}from"./Layout-743c9242.js";/* empty css            */function N(){const{flash:s,errors:a}=u().props,[t,n]=o.useState([]),[d,i]=o.useState(!1),m=l=>{const r=Array.from(l.target.files);n(r)},x=l=>{if(l.preventDefault(),t.length===0){alert("Please select at least one CSV file to import");return}const r=new FormData;t.forEach((h,p)=>{r.append(`csv_files[${p}]`,h)}),i(!0),c.post("/attendance/import",r,{forceFormData:!0,onSuccess:()=>{i(!1),n([])},onError:()=>{i(!1),alert("Import failed. Check error messages.")},onFinish:()=>{i(!1)}})};return e.jsx(b,{children:e.jsxs("div",{className:"py-4 max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Import Attendance from CSV"}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("form",{onSubmit:x,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload CSV Files (Multiple)"}),e.jsx("input",{type:"file",accept:".csv,.txt",multiple:!0,onChange:m,className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),t.length>0&&e.jsxs("div",{className:"mt-2 text-sm text-green-600",children:[e.jsxs("p",{className:"font-semibold",children:["Selected ",t.length," file",t.length>1?"s":"",":"]}),e.jsx("ul",{className:"list-disc ml-5 mt-1",children:t.map((l,r)=>e.jsx("li",{children:l.name},r))})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"ðŸ“‹ CSV Format"}),e.jsxs("div",{className:"space-y-3 text-sm text-blue-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-1",children:"Expected Format:"}),e.jsx("code",{className:"bg-white px-2 py-1 rounded text-xs block",children:"Ime i prezime, ÄŒlanski broj, 2025-09-04, 2025-09-05, 2025-09-06, ..."})]}),e.jsxs("div",{className:"bg-white rounded p-3 mt-2",children:[e.jsx("p",{className:"font-medium mb-2",children:"Example:"}),e.jsxs("code",{className:"text-xs block",children:["Ime i prezime,ÄŒlanski broj,2025-09-04,2025-09-05,2025-09-06",e.jsx("br",{}),"Zoran TrandafiloviÄ‡,6,TRUE,TRUE,TRUE",e.jsx("br",{}),"SneÅ¾ana Rajh,5,TRUE,FALSE,TRUE"]})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-300 rounded p-2 mt-2",children:[e.jsx("p",{className:"font-medium",children:"âœ¨ Import Features:"}),e.jsxs("ul",{className:"list-disc ml-5 mt-1",children:[e.jsx("li",{children:"Date columns auto-detected (format: YYYY-MM-DD, e.g., 2025-09-04)"}),e.jsx("li",{children:"Matches members by membership number (second column)"}),e.jsx("li",{children:'Creates sessions with "Training" type by default'}),e.jsx("li",{children:"TRUE/FALSE values mark attendance"}),e.jsx("li",{children:"First row automatically skipped (for totals/summary)"}),e.jsx("li",{children:"Last column automatically ignored (for totals)"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"ðŸ“ Cell Values"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"TRUE"})," â†’ Member attended session"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"FALSE"})," â†’ Member did not attend"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Empty"})," â†’ Treated as FALSE"]})]})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-purple-900 mb-2",children:"ðŸŽ¯ Session Type"}),e.jsxs("p",{className:"text-sm text-purple-800",children:["All imported sessions will be created as ",e.jsx("strong",{children:'"Training"'})," type. You can manually change session types after import if needed."]})]}),e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-orange-900 mb-2",children:"âš ï¸ Important Notes"}),e.jsxs("ul",{className:"text-sm text-orange-800 space-y-1",children:[e.jsxs("li",{children:["â€¢ This will ",e.jsx("strong",{children:"CREATE or UPDATE"})," attendance records"]}),e.jsx("li",{children:"â€¢ Sessions will be created if they don't exist for the dates"}),e.jsx("li",{children:"â€¢ Maximum file size: 5 MB"}),e.jsx("li",{children:"â€¢ Ensure all membership numbers exist in the system"}),e.jsx("li",{children:"â€¢ First row must contain column headers"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>c.get("/attendance"),className:"px-6 py-2 border border-gray-300 rounded-md hover:bg-gray-50",disabled:d,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed",disabled:d,children:d?"Importing...":"Import Attendance"})]})]})}),(s==null?void 0:s.success)&&e.jsx("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("p",{className:"text-green-800",children:s.success})}),(s==null?void 0:s.error)&&e.jsx("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:s.error})}),(a==null?void 0:a.csv_file)&&e.jsx("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:a.csv_file})}),(s==null?void 0:s.import_errors)&&s.import_errors.length>0&&e.jsxs("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-red-900 mb-2",children:"Import Errors:"}),e.jsx("ul",{className:"text-sm text-red-800 space-y-1",children:s.import_errors.map((l,r)=>e.jsxs("li",{children:["â€¢ ",l]},r))})]})]})]})})}export{N as default};
