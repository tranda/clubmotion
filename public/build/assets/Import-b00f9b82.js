import{u as h,r as n,j as e,a as c}from"./app-d5eadcf8.js";import{L as b}from"./Layout-c73747f8.js";/* empty css            */function j(){const{flash:s,errors:t}=h().props,[r,m]=n.useState(null),[a,i]=n.useState(!1),x=l=>{if(l.preventDefault(),console.log("Form submitted"),console.log("File:",r),!r){alert("Please select a CSV file to import");return}const o=new FormData;o.append("csv_file",r),console.log("Starting import..."),i(!0),c.post("/payments/import",o,{forceFormData:!0,onStart:()=>{console.log("Request started")},onSuccess:d=>{console.log("Success:",d),i(!1)},onError:d=>{console.error("Import errors:",d),i(!1),alert("Import failed. Check console and error messages.")},onFinish:()=>{console.log("Request finished"),i(!1)}})};return e.jsx(b,{children:e.jsxs("div",{className:"py-4 max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Import Payments from CSV"}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("form",{onSubmit:x,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload CSV File"}),e.jsx("input",{type:"file",accept:".csv,.txt",onChange:l=>m(l.target.files[0]),className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),r&&e.jsxs("p",{className:"mt-2 text-sm text-green-600",children:["Selected: ",r.name]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-3",children:"📋 CSV Format (Auto-Detects Year & Month)"}),e.jsxs("div",{className:"space-y-3 text-sm text-blue-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-1",children:"Column Format:"}),e.jsx("code",{className:"bg-white px-2 py-1 rounded text-xs block",children:"Članski broj, Email, jAN 2022, fEB 2022, mAR 2022, ..., JAN 2023, FEB 2023, ..."})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-300 rounded p-2 mt-2",children:[e.jsx("p",{className:"font-medium",children:"✨ Smart Import:"}),e.jsxs("ul",{className:"list-disc ml-5 mt-1",children:[e.jsx("li",{children:"Automatically detects year and month from column headers"}),e.jsx("li",{children:"Supports multiple years in one file (2022, 2023, 2024, 2025...)"}),e.jsx("li",{children:"Handles Serbian month names (mAJ, oKT, etc.)"}),e.jsx("li",{children:"First column: Membership Number, Second: Email"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"📝 Cell Values"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Numbers"})," (e.g., 2500, 1000) → Marked as ",e.jsx("span",{className:"text-green-600 font-semibold",children:"paid"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:'"pocasni"'})," → Marked as ",e.jsx("span",{className:"text-gray-600 font-semibold",children:"exempt"})," (honorary member)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:'"saradnik"'})," → Marked as ",e.jsx("span",{className:"text-gray-600 font-semibold",children:"exempt"})," (associate)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:'"free"'})," → Marked as ",e.jsx("span",{className:"text-gray-600 font-semibold",children:"exempt"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Empty"})," → Skipped (no record created)"]})]})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-yellow-900 mb-2",children:"🔍 Member Matching Priority"}),e.jsxs("ol",{className:"text-sm text-yellow-800 space-y-1 list-decimal list-inside",children:[e.jsxs("li",{children:["Try to match by ",e.jsx("strong",{children:"Membership Number"})," (first column)"]}),e.jsxs("li",{children:["If not found, match by ",e.jsx("strong",{children:"Email"})," (second column)"]}),e.jsx("li",{children:"If neither matches, skip row and log error"})]})]}),e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-orange-900 mb-2",children:"⚠️ Important Notes"}),e.jsxs("ul",{className:"text-sm text-orange-800 space-y-1",children:[e.jsxs("li",{children:["• This will ",e.jsx("strong",{children:"UPDATE"})," existing payment records if they exist"]}),e.jsx("li",{children:"• Maximum file size: 5 MB"}),e.jsx("li",{children:"• Ensure all member emails/numbers exist in the system"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>c.get("/payments"),className:"px-6 py-2 border border-gray-300 rounded-md hover:bg-gray-50",disabled:a,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300 disabled:cursor-not-allowed",disabled:a,children:a?"Importing...":"Import Payments"})]})]})}),(s==null?void 0:s.success)&&e.jsx("div",{className:"mt-6 bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("p",{className:"text-green-800",children:s.success})}),(s==null?void 0:s.error)&&e.jsx("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:s.error})}),(t==null?void 0:t.csv_file)&&e.jsx("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:t.csv_file})}),(s==null?void 0:s.import_errors)&&s.import_errors.length>0&&e.jsxs("div",{className:"mt-6 bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-red-900 mb-2",children:"Import Errors:"}),e.jsx("ul",{className:"text-sm text-red-800 space-y-1",children:s.import_errors.map((l,o)=>e.jsxs("li",{children:["• ",l]},o))})]})]})]})})}export{j as default};
